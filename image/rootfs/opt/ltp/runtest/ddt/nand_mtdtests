# @name Nand mtdtests 
# @desc Performance mtdtest suite including oobtest, pagetest, readtest, speedtest, stresstest, subpagetest and nandecctest. 
# @requires nand

NAND_L_MODULAR_MTD_OOBTEST source "common.sh"; install_modules.sh "nand"; rmmod.sh "mtd_oobtest"; part=`get_mtd_partition_number.sh "nand"`; do_cmd flash_eraseall -q /dev/mtd$part; do_cmd sleep 1; dmesg -c > /dev/null; do_cmd insmod.sh "mtd_oobtest" dev="$part"; dmesg; dmesg | grep -E "finished\s+with\s+0\s+errors" && rmmod.sh "mtd_oobtest";exit 0 || rmmod.sh "mtd_oobtest";exit 1

NAND_L_MODULAR_MTD_PAGETEST source "common.sh"; install_modules.sh "nand"; rmmod.sh "mtd_pagetest"; part=`get_mtd_partition_number.sh "nand"`; do_cmd flash_eraseall -q /dev/mtd$part; do_cmd sleep 1; dmesg -c > /dev/null; do_cmd insmod.sh "mtd_pagetest" dev="$part"; dmesg; dmesg | grep -E "finished\s+with\s+0\s+errors" && rmmod.sh "mtd_pagetest";exit 0 || rmmod.sh "mtd_pagetest";exit 1 

NAND_L_MODULAR_MTD_READTEST source "common.sh"; install_modules.sh "nand"; rmmod.sh "mtd_readtest"; part=`get_mtd_partition_number.sh "nand"`; do_cmd flash_eraseall -q /dev/mtd$part; do_cmd sleep 1; dmesg -c > /dev/null; do_cmd insmod.sh "mtd_readtest" dev="$part"; dmesg; dmesg | grep "mtd_readtest:\s+finished" && rmmod.sh "mtd_readtest";exit 0 || rmmod.sh "mtd_readtest";exit 1

NAND_L_MODULAR_MTD_SPEEDTEST source "common.sh"; install_modules.sh "nand"; rmmod.sh "mtd_speedtest"; part=`get_mtd_partition_number.sh "nand"`; do_cmd flash_eraseall -q /dev/mtd$part; do_cmd sleep 1; dmesg -c > /dev/null; do_cmd insmod.sh "mtd_speedtest" dev="$part"; dmesg; dmesg | grep "mtd_speedtest:\s+finished" && rmmod.sh "mtd_speedtest";exit 0 || rmmod.sh "mtd_speedtest";exit 1

NAND_L_MODULAR_MTD_STRESSTEST source "common.sh"; install_modules.sh "nand"; rmmod.sh "mtd_stresstest"; part=`get_mtd_partition_number.sh "nand"`; do_cmd flash_eraseall -q /dev/mtd$part; do_cmd sleep 1; dmesg -c > /dev/null; do_cmd insmod.sh "mtd_stresstest" dev="$part"; dmesg; dmesg | grep "mtd_stresstest:\s+finished" && rmmod.sh "mtd_stresstest";exit 0 || rmmod.sh "mtd_stresstest";exit 1

NAND_L_MODULAR_MTD_SUBPAGETEST source "common.sh"; install_modules.sh "nand"; rmmod.sh "mtd_subpagetest"; part=`get_mtd_partition_number.sh "nand"`; do_cmd flash_eraseall -q /dev/mtd$part; do_cmd sleep 1; dmesg -c > /dev/null; do_cmd insmod.sh "mtd_subpagetest" dev="$part"; dmesg; dmesg | grep -E "finished\s+with\s+0\s+errors" && rmmod.sh "mtd_subpagetest";exit 0 || rmmod.sh "mtd_subpagetest";exit 1 

NAND_L_MODULAR_MTD_NANDECCTEST source "common.sh"; install_modules.sh "nand"; part=`get_mtd_partition_number.sh "nand"`; do_cmd flash_eraseall -q /dev/mtd$part; do_cmd sleep 1; do_cmd sleep 1; do_cmd insmod.sh "mtd_nandecctest"; do_cmd rmmod.sh "mtd_nandecctest" 





